<!DOCTYPE html>
<html lang="en">
	<head>

		<meta charset="utf-8"/>
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>

		<title>Ccall : 1-Click Conference Calls</title>

		<link rel="stylesheet" type="text/css" href="css/style.css"/>
		<script type="text/javascript" src="//use.typekit.net/rrf5isi.js"></script>
		<script type="text/javascript">
			try {
				Typekit.load();
			} catch(e) {
			}
		</script>

		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
		<script src="js/purl.js"></script>

		<script type="text/javascript">
			$(document).ready(function() {
				var confNumber = $.url().param("n");
				var confID = $.url().param("i");
				var useHash = (($.url().param("useHash") == 'true') ? (true) : (false) );
				
				if (/Android/i.test(navigator.userAgent)) {
					// console.log('Android');
					directMobileUser('android');
				} else if (/iPhone/i.test(navigator.userAgent)) {
					// console.log('iPhone');
					directMobileUser('ios');
				}else if(/Windows Phone/i.test(navigator.userAgent)) {
					// console.log('windows phone');
					directMobileUser('windows');
				} else {
					// unsupported device
					// console.log('unsupported device');
					$('div.resultDiv').html('Put the link in a calendar invite or email (or whatever).');
				}
				
				$('#cc-logo').click(function() {
					var httpBase = $(location).attr('href').substring(0, $(location).attr('href').lastIndexOf("/") + 1);
					window.location = httpBase;
				});
				$('#cc-logo').hover(function() {
			        $(this).css('cursor','pointer');
			    });
			});
			
			
		    
			function directMobileUser(os) {
				
				if (os=='ios') {
					$('div.resultDiv').html('Thanks!<br/><a href="https://github.com/TheExperiment/ccall">Fork us on GitHub and help out with other platforms!</a>');
					window.location = 'tel:' + confNumber + ',,,' + confID + ((useHash) ? ('#') : ('') );
				} else if (os=='android') {
					
					// console.log('unsupported device');
					$('div.resultDiv').html('Not currently supported on Android (we can\'t seem to get it to work)<br/><a href="https://github.com/TheExperiment/ccall">Fork us on GitHub and help out!</a>');
					
					/*
					 * is Android - annoyingly have not been able to get it to retain the extension
					 * below are all the attempted formats, everything i could find - fail
					 * I think it just may not allow it. Prove me wrong.
					 */
					// window.location = 'tel:' + confNumber;

					// <a data-rel="external" href="tel:1231231234">(123) 123-1234</a>

					// window.location = 'tel:' + confNumber + '%2C%2C%2C' + confID + ((useHash) ? ('%23') : ('') );
					// window.location = 'tel:' + confNumber + '%2C%2C%2C' + confID + ((useHash) ? ('') : ('') );

					// window.location = 'tel:' + confNumber + 'T' + confID + ((useHash) ? ('') : ('') );

					// window.location = 'tel:+1-866-203-7011%2C9587123509';

					// $('div.resultDiv').append( '<a data-rel="external" href="tel:' + confNumber + ' ppp ' + confID + ((useHash) ? ('#') : ('')) + '">DIAL!!!</a> <br /><br />'  );

					// $('div.resultDiv').append( '<a href="tel:' + confNumber + ';postd=' + confID + ((useHash) ? ('#') : ('')) + '">VERSION 1</a> <br /><br />'  );
					// $('div.resultDiv').append( '<a href="tel:' + confNumber + 'pp' + confID + ((useHash) ? ('#') : ('')) + '">VERSION 2</a> <br /><br />'  );
					// $('div.resultDiv').append( '<a href="tel:' + confNumber + ';pp' + confID + ((useHash) ? ('#') : ('')) + '">VERSION 3</a> <br /><br />'  );
					// $('div.resultDiv').append( '<a href="wtai://wp/mc;:' + confNumber + '">wtai://wp/mc;+1800229933</a> <br /><br />'  );
				} else if (os=='windows') {
					// no clue here... 
					$('div.resultDiv').html('Not currently supported on Windows Mobile<br/><a href="https://github.com/TheExperiment/ccall">Fork us on GitHub and help out!</a>');
				}
			}
		</script>
	</head>

	<body lang="en">
		<div id="container">
			<div id="main">
				<div id="cc-logo" class="logo" alt="ccall">
					c
				</div>
				<h1><div class="resultDiv"></div></h1>
			</div>
		</div>
	</body>
</html>
